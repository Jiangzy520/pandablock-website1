<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é‚®ä»¶é€šçŸ¥æµ‹è¯•å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-width: 800px;
      width: 100%;
      padding: 40px;
    }

    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 28px;
    }

    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }

    .test-section {
      margin-bottom: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      border-left: 4px solid #667eea;
    }

    .test-section h2 {
      color: #333;
      margin-bottom: 15px;
      font-size: 18px;
    }

    .test-section p {
      color: #666;
      margin-bottom: 15px;
      line-height: 1.6;
    }

    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }

    button:active {
      transform: translateY(0);
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
      box-shadow: none;
    }

    .result {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.6;
      white-space: pre-wrap;
      word-wrap: break-word;
      max-height: 400px;
      overflow-y: auto;
    }

    .result.success {
      background: #d4edda;
      border: 1px solid #c3e6cb;
      color: #155724;
    }

    .result.error {
      background: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
    }

    .result.info {
      background: #d1ecf1;
      border: 1px solid #bee5eb;
      color: #0c5460;
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      margin-left: 10px;
      vertical-align: middle;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .checklist {
      margin-top: 20px;
      padding: 20px;
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      border-radius: 8px;
    }

    .checklist h3 {
      color: #856404;
      margin-bottom: 15px;
      font-size: 16px;
    }

    .checklist ul {
      list-style: none;
      padding-left: 0;
    }

    .checklist li {
      color: #856404;
      margin-bottom: 10px;
      padding-left: 25px;
      position: relative;
    }

    .checklist li:before {
      content: "â–¡";
      position: absolute;
      left: 0;
      font-size: 18px;
    }

    .link {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
    }

    .link:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“§ é‚®ä»¶é€šçŸ¥æµ‹è¯•å·¥å…·</h1>
    <p class="subtitle">æµ‹è¯• PandaBlock AI èŠå¤©æœºå™¨äººçš„é‚®ä»¶é€šçŸ¥åŠŸèƒ½</p>

    <!-- æµ‹è¯• 1 -->
    <div class="test-section">
      <h2>ğŸ§ª æµ‹è¯• 1ï¼šåŸºç¡€é‚®ä»¶å‘é€</h2>
      <p>å‘é€ä¸€æ¡ç®€å•çš„æµ‹è¯•æ¶ˆæ¯ï¼ŒéªŒè¯é‚®ä»¶é€šçŸ¥æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p>
      <button onclick="test1()" id="btn1">è¿è¡Œæµ‹è¯• 1</button>
      <div id="result1"></div>
    </div>

    <!-- æµ‹è¯• 2 -->
    <div class="test-section">
      <h2>ğŸ§ª æµ‹è¯• 2ï¼šåŒ…å«è”ç³»æ–¹å¼çš„æ¶ˆæ¯</h2>
      <p>å‘é€åŒ…å« Telegram è”ç³»æ–¹å¼çš„æ¶ˆæ¯ï¼ŒéªŒè¯ä¿¡æ¯æå–åŠŸèƒ½ã€‚</p>
      <button onclick="test2()" id="btn2">è¿è¡Œæµ‹è¯• 2</button>
      <div id="result2"></div>
    </div>

    <!-- æµ‹è¯• 3 -->
    <div class="test-section">
      <h2>ğŸ§ª æµ‹è¯• 3ï¼šå®Œæ•´çš„é¡¹ç›®å’¨è¯¢</h2>
      <p>æ¨¡æ‹ŸçœŸå®çš„é¡¹ç›®å’¨è¯¢ï¼ŒåŒ…å«è”ç³»æ–¹å¼ã€éœ€æ±‚å’Œé¢„ç®—ã€‚</p>
      <button onclick="test3()" id="btn3">è¿è¡Œæµ‹è¯• 3</button>
      <div id="result3"></div>
    </div>

    <!-- æ£€æŸ¥æ¸…å• -->
    <div class="checklist">
      <h3>ğŸ“‹ æµ‹è¯•åæ£€æŸ¥æ¸…å•</h3>
      <ul>
        <li>æ£€æŸ¥é‚®ç®± <strong>hayajaiahk@gmail.com</strong> çš„æ”¶ä»¶ç®±</li>
        <li>æ£€æŸ¥åƒåœ¾é‚®ä»¶æ–‡ä»¶å¤¹ï¼ˆæœ€å¸¸è§åŸå› ï¼‰</li>
        <li>æŸ¥çœ‹ <a href="https://vercel.com/dashboard" target="_blank" class="link">Vercel å‡½æ•°æ—¥å¿—</a></li>
        <li>æŸ¥çœ‹ <a href="https://resend.com/emails" target="_blank" class="link">Resend å‘é€è®°å½•</a></li>
        <li>ç¡®è®¤ç¯å¢ƒå˜é‡ RESEND_API_KEY å·²é…ç½®</li>
      </ul>
    </div>
  </div>

  <script>
    const API_URL = 'https://www.pandablockdev.com/api/chat';

    async function sendTestMessage(message, conversationHistory = []) {
      const response = await fetch(API_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          message: message,
          conversationHistory: conversationHistory
        })
      });

      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }

      return await response.json();
    }

    function showResult(elementId, message, type = 'info') {
      const resultDiv = document.getElementById(elementId);
      resultDiv.className = `result ${type}`;
      resultDiv.textContent = message;
    }

    function showLoading(buttonId) {
      const button = document.getElementById(buttonId);
      button.disabled = true;
      button.innerHTML = button.textContent + '<span class="loading"></span>';
    }

    function hideLoading(buttonId, originalText) {
      const button = document.getElementById(buttonId);
      button.disabled = false;
      button.textContent = originalText;
    }

    async function test1() {
      const buttonId = 'btn1';
      const resultId = 'result1';
      const originalText = 'è¿è¡Œæµ‹è¯• 1';

      showLoading(buttonId);
      showResult(resultId, 'â³ å‘é€æµ‹è¯•æ¶ˆæ¯ä¸­...', 'info');

      try {
        const data = await sendTestMessage('ä½ å¥½ï¼Œæµ‹è¯•é‚®ä»¶é€šçŸ¥åŠŸèƒ½');

        showResult(resultId, 
          `âœ… API è°ƒç”¨æˆåŠŸï¼\n\n` +
          `ğŸ“¤ å·²å‘é€æµ‹è¯•æ¶ˆæ¯\n` +
          `ğŸ“§ è¯·æ£€æŸ¥é‚®ç®±ï¼šhayajaiahk@gmail.com\n` +
          `ğŸ“ å¦‚æœæ”¶ä»¶ç®±æ²¡æœ‰ï¼Œè¯·æ£€æŸ¥åƒåœ¾é‚®ä»¶æ–‡ä»¶å¤¹\n\n` +
          `AI å›å¤ï¼š\n${data.reply}\n\n` +
          `â° ç­‰å¾… 1-2 åˆ†é’Ÿåæ£€æŸ¥é‚®ç®±\n` +
          `ğŸ” åŒæ—¶æŸ¥çœ‹ Vercel æ—¥å¿—ç¡®è®¤å‘é€çŠ¶æ€`,
          'success'
        );

        console.log('âœ… æµ‹è¯• 1 å®Œæˆ');
        console.log('ğŸ“§ é‚®ä»¶åº”è¯¥å‘é€åˆ°ï¼šhayajaiahk@gmail.com');
        console.log('ğŸ“Š AI å›å¤:', data.reply);
      } catch (error) {
        showResult(resultId, 
          `âŒ æµ‹è¯•å¤±è´¥\n\n` +
          `é”™è¯¯ä¿¡æ¯ï¼š${error.message}\n\n` +
          `å¯èƒ½çš„åŸå› ï¼š\n` +
          `1. API ç«¯ç‚¹æ— æ³•è®¿é—®\n` +
          `2. ç½‘ç»œè¿æ¥é—®é¢˜\n` +
          `3. æœåŠ¡å™¨é”™è¯¯\n\n` +
          `è¯·æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†é”™è¯¯`,
          'error'
        );
        console.error('âŒ æµ‹è¯• 1 å¤±è´¥:', error);
      } finally {
        hideLoading(buttonId, originalText);
      }
    }

    async function test2() {
      const buttonId = 'btn2';
      const resultId = 'result2';
      const originalText = 'è¿è¡Œæµ‹è¯• 2';

      showLoading(buttonId);
      showResult(resultId, 'â³ å‘é€åŒ…å«è”ç³»æ–¹å¼çš„æ¶ˆæ¯...', 'info');

      try {
        const data = await sendTestMessage(
          'æˆ‘æƒ³åšä¸€ä¸ª NFT é¡¹ç›®ï¼Œæˆ‘çš„ Telegram æ˜¯ @test_user_12345'
        );

        showResult(resultId, 
          `âœ… API è°ƒç”¨æˆåŠŸï¼\n\n` +
          `ğŸ“¤ å·²å‘é€åŒ…å«è”ç³»æ–¹å¼çš„æ¶ˆæ¯\n` +
          `ğŸ“ è”ç³»æ–¹å¼ï¼š@test_user_12345\n` +
          `ğŸ“§ é‚®ä»¶åº”è¯¥åŒ…å«æå–çš„è”ç³»æ–¹å¼\n\n` +
          `AI å›å¤ï¼š\n${data.reply}\n\n` +
          `â° ç­‰å¾… 1-2 åˆ†é’Ÿåæ£€æŸ¥é‚®ç®±\n` +
          `âœ… é‚®ä»¶å†…å®¹åº”è¯¥åŒ…å«ï¼š\n` +
          `   - è”ç³»æ–¹å¼ï¼š@test_user_12345\n` +
          `   - é¡¹ç›®éœ€æ±‚ï¼šNFT\n` +
          `   - å®Œæ•´å¯¹è¯è®°å½•`,
          'success'
        );

        console.log('âœ… æµ‹è¯• 2 å®Œæˆ');
        console.log('ğŸ“§ é‚®ä»¶åº”è¯¥åŒ…å«è”ç³»æ–¹å¼ï¼š@test_user_12345');
      } catch (error) {
        showResult(resultId, 
          `âŒ æµ‹è¯•å¤±è´¥\n\né”™è¯¯ä¿¡æ¯ï¼š${error.message}`,
          'error'
        );
        console.error('âŒ æµ‹è¯• 2 å¤±è´¥:', error);
      } finally {
        hideLoading(buttonId, originalText);
      }
    }

    async function test3() {
      const buttonId = 'btn3';
      const resultId = 'result3';
      const originalText = 'è¿è¡Œæµ‹è¯• 3';

      showLoading(buttonId);
      showResult(resultId, 'â³ æ¨¡æ‹Ÿå®Œæ•´çš„é¡¹ç›®å’¨è¯¢...', 'info');

      try {
        // ç¬¬ä¸€è½®å¯¹è¯
        const msg1 = await sendTestMessage('ä½ å¥½');
        
        // ç¬¬äºŒè½®å¯¹è¯
        const history1 = [
          { role: 'user', content: 'ä½ å¥½' },
          { role: 'assistant', content: msg1.reply }
        ];
        const msg2 = await sendTestMessage('æˆ‘æƒ³åšä¸€ä¸ª NFT é“¸é€ ç½‘ç«™', history1);

        // ç¬¬ä¸‰è½®å¯¹è¯ï¼ˆåŒ…å«å®Œæ•´ä¿¡æ¯ï¼‰
        const history2 = [
          ...history1,
          { role: 'user', content: 'æˆ‘æƒ³åšä¸€ä¸ª NFT é“¸é€ ç½‘ç«™' },
          { role: 'assistant', content: msg2.reply }
        ];
        const msg3 = await sendTestMessage(
          'éœ€è¦ç›²ç›’å’Œç™½åå•åŠŸèƒ½ï¼Œæˆ‘çš„ Telegram æ˜¯ @test_user_fullï¼Œé¢„ç®—å¤§æ¦‚ $3000',
          history2
        );

        showResult(resultId, 
          `âœ… å®Œæ•´å¯¹è¯æµ‹è¯•æˆåŠŸï¼\n\n` +
          `ğŸ“¤ å·²å‘é€ 3 è½®å¯¹è¯\n` +
          `ğŸ“§ æœ€åä¸€å°é‚®ä»¶åº”è¯¥åŒ…å«ï¼š\n\n` +
          `ğŸ“ è”ç³»æ–¹å¼ï¼š@test_user_full\n` +
          `ğŸ“‹ é¡¹ç›®éœ€æ±‚ï¼šNFT é“¸é€ ç½‘ç«™ï¼Œç›²ç›’å’Œç™½åå•åŠŸèƒ½\n` +
          `ğŸ’° é¢„ç®—èŒƒå›´ï¼š$3000\n` +
          `ğŸ’¬ å®Œæ•´å¯¹è¯å†å²ï¼ˆ3 è½®ï¼‰\n\n` +
          `æœ€åä¸€è½® AI å›å¤ï¼š\n${msg3.reply}\n\n` +
          `â° ç­‰å¾… 1-2 åˆ†é’Ÿåæ£€æŸ¥é‚®ç®±\n` +
          `ğŸ¯ è¿™æ˜¯æœ€å®Œæ•´çš„æµ‹è¯•ï¼Œé‚®ä»¶åº”è¯¥åŒ…å«æ‰€æœ‰ä¿¡æ¯`,
          'success'
        );

        console.log('âœ… æµ‹è¯• 3 å®Œæˆ');
        console.log('ğŸ“§ é‚®ä»¶åº”è¯¥åŒ…å«å®Œæ•´çš„é¡¹ç›®ä¿¡æ¯');
        console.log('ğŸ“Š å¯¹è¯è½®æ•°ï¼š3');
      } catch (error) {
        showResult(resultId, 
          `âŒ æµ‹è¯•å¤±è´¥\n\né”™è¯¯ä¿¡æ¯ï¼š${error.message}`,
          'error'
        );
        console.error('âŒ æµ‹è¯• 3 å¤±è´¥:', error);
      } finally {
        hideLoading(buttonId, originalText);
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆåçš„æç¤º
    window.addEventListener('load', () => {
      console.log('ğŸ“§ é‚®ä»¶é€šçŸ¥æµ‹è¯•å·¥å…·å·²åŠ è½½');
      console.log('ğŸ¯ ç‚¹å‡»æŒ‰é’®è¿è¡Œæµ‹è¯•');
      console.log('ğŸ“Š æµ‹è¯•å®Œæˆåï¼š');
      console.log('   1. æ£€æŸ¥é‚®ç®± hayajaiahk@gmail.com');
      console.log('   2. æ£€æŸ¥åƒåœ¾é‚®ä»¶æ–‡ä»¶å¤¹');
      console.log('   3. æŸ¥çœ‹ Vercel å‡½æ•°æ—¥å¿—');
      console.log('   4. æŸ¥çœ‹ Resend Dashboard');
    });
  </script>
</body>
</html>

